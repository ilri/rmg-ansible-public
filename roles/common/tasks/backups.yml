---

- name: Install mailx on CentOS hosts
  yum: name=mailx state=present
  when: ansible_distribution == 'CentOS'
  tags: packages

# Use heirloom-mailx on Ubuntu systems <= 16.04
# TODO: convert this to s-nail on newer Ubuntu systems
- name: Install heirloom-mailx on Debian-based hosts
  apt: name=heirloom-mailx state=present
  when: ansible_distribution == 'Debian' or
        (ansible_distribution == 'Ubuntu' and ansible_distribution_version is version_compare('16.04', '<='))
  tags: packages

- name: Copy backup scripts
  copy: src={{ item }} dest=/opt/ilri/scripts/ owner=root group=root mode=0755
  with_fileglob:
    - scripts/*.sh

- name: Copy MySQL backup script
  template: src={{ item.src }} dest={{ item.dest }} owner=root group=root mode=0750
  loop:
    - { src: "scripts/backup_mysql.py.j2", dest: "/opt/ilri/scripts/backup_mysql.py" }

# vim: set sw=2 ts=2:

---

- name: Install disk utilities
  yum: name={{ item }} state=installed
  with_items:
    - gdisk
    - xfsprogs

- name: Install glusterfs-server dependencies
  yum: name={{ item }} state=present
  with_items:
    - rpcbind
    - nfs-utils

- name: Copy glusterfs-epel.repo
  when: ansible_distribution == 'CentOS'
  copy: src=glusterfs-epel.repo dest=/etc/yum.repos.d/glusterfs-epel.repo owner=root group=root mode=0644

- name: Install glusterfs-server
  when: ansible_distribution == 'CentOS'
  command: /usr/bin/yum --disablerepo=* --enablerepo=glusterfs-epel -y install glusterfs-server

- name: Start & enable glusterd service
  service: name=glusterd state=started enabled=true

# belongs in a proper "storage" role, but this will have to do for now
- name: Remove irqbalance
  yum: name=irqbalance state=absent
  tags: irqbalance

# vim: set sw=2 ts=2:

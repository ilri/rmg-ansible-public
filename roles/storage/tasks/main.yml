---
- name: Set fact for old GlusterFS package repositories
  ansible.builtin.set_fact:
    old_glusterfs_package_repositories:
      - centos-release-gluster5
      - centos-release-gluster6
      - centos-release-gluster7
      - centos-release-gluster8

- name: Remove old GlusterFS package repositories
  ansible.builtin.package:
    name: "{{ old_glusterfs_package_repositories }}"
    state: absent

- name: Enable GlusterFS packages from CentOS SIG
  ansible.builtin.package:
    name: centos-release-gluster9
    state: present

- name: Configure Mellanox network cards
  ansible.builtin.include_tasks: mellanox.yml
  tags: mellanox

- name: Configure GlusterFS client
  ansible.builtin.include_tasks: client.yml
  when: glusterfs_role == 'client'
  tags: glusterfs-client

- name: Configure GlusterFS server
  ansible.builtin.include_tasks: server.yml
  when: glusterfs_role == 'server'
  tags: glusterfs-server

# vim: set sw=2 ts=2:
